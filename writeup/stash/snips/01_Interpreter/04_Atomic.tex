{\scriptsize
\begin{align*}
& \hspace{0em}    \atomf : Atom ‚Üí ‚Ñ≥ (Exp)                                       \\
& \hspace{0em}    \atomf(a) := \ddo                                             \\
& \hspace{2em}      v ‚Üê ùíú ‚ü¶a‚üß                                                   \\
& \hspace{2em}      fr ‚Üê \popkon                                                \\
& \hspace{2em}      \case{fr}                                                   \\
& \hspace{4em}        [ ‚ñ°  \op e ] ‚Üí \ddo                                       \\
& \hspace{6em}          \pushkon([ v \op ‚ñ° ])                                   \\
& \hspace{6em}          \ret(e)                                                 \\
& \hspace{4em}        [ v' \op ‚ñ° ] ‚Üí \failonbot(\delta(\op, v', v))             \\
& \hspace{4em}        [ ‚ñ°  \ap e ] ‚Üí \ddo                                       \\
& \hspace{6em}          \pushkon([ v \ap ‚ñ° ])                                   \\
& \hspace{6em}          \ret(e)                                                 \\
& \hspace{4em}        [ v' \ap ‚ñ° ] ‚Üí \ddo                                       \\
& \hspace{6em}          ‚ü® \lam(x) ‚Üí e, œÅ' ‚ü© ‚Üê \failonbot(\coerce{Clo}(v'))      \\
& \hspace{6em}          \putenv(œÅ'[x ‚Ü¶ v])                                      \\
& \hspace{6em}          \ret(e)                                                 \\
& \hspace{4em}        [ \ifz{‚ñ°}{e‚ÇÅ}{e‚ÇÇ} ] ‚Üí \mif{v ‚âü 0}{\ret(e‚ÇÅ)}{\ret(e‚ÇÇ)}     \\
\end{align*}
}
